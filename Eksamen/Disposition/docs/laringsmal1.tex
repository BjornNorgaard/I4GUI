\section{Redegøre for principperne i .NET frameworket og dets overordnede arkitektur samt beskrive og anvende programmeringssproget C\#}\label{sec:spm1}

\subsection{Hvad er .NET?}


% Skal omkring!!
%% CLR runtime thing...
%% Intermediete language, som clr oversætter...

\subsection{Principper i .NET frameworket}

%\begin{itemize}
%	\item Lige til højrebenet
%\end{itemize}

\subsection{Garbage Collection}
Også kendt som \textbf{Managed Heap}. I de \textit{gode gamle dage} var den samme dans nødvendig hver gang en ressource skulle bruges:

\begin{enumerate}
	\item \textbf{Allocate} memory for resource (new operator).
	\item \textbf{Initialize} memory to make resource usable (constructor).
	\item Use the resource (acces members) - repeat as necessary.
	\item \textbf{Tear-down} the resource (destructor).
	\item Free the memory.
\end{enumerate}

Dette fører typisk til nogle almindelige problemer, såsom \textbf{memory leaks} og \textbf{memory corruption}\footnote{Når hukommelse bruges efter frigivelse.}. Dette er seriøse problemer fordi \textit{timing} og \textit{consequence} er uforudsigelige (meget svært at debugge).

\subsubsection{Enter Mr. Garbage Collector} 
Et object \textit{frigives} aldrig i kode. GC\footnote{Garbage Collector} frigiver objecter når de ikke længere er tilgængelige (\textit{reachable}).

\begin{figure}[h]
	\centering
	\includegraphics[width=\linewidth]{figs/nextobjptr}
	\caption{Garbage collector's \textit{NextObjectPointer}.}
	\label{fig:nextobjptr}
\end{figure}

\paragraph{Allokering}
\begin{itemize}
	\item Hver process har sin egen virtuelle address space region.
	\item GC sker concurrent, bag om ryggen på os.
	\item Allokering sker i enden af heapen, ved \textit{NextObjPtr} se figur~\ref{fig:nextobjptr}. Hvilket gør denne allokering meget hurtigere end \textit{unmanaged} \textit{new/malloc/HeapAlloc}.
	\item Større objekter\footnote{Over 85KB, kan ændres af microsoft.} allokeres på en speciel heap.
\end{itemize}

\paragraph{Collection ''Mark and Compact''}
\begin{enumerate}
	\item \textbf{Marking}\\
	Objekter som kan \textit{nås} bliver markeret (kaldet \textit{Roots}).
	\item \textbf{Compacting}\\
	Markerede objekter bliver \textit{shifted} ned over de umarkerede.
	\item Hvis alle objekter er markerede forekommer der ikke nogen compacting. Hvis der ikke er mere hukommelse bliver en \textit{OutOfMemoryException} smidt.
\end{enumerate}

\begin{figure}[h]
\centering
\includegraphics[width=0.8\linewidth]{figs/markandsweep}
\caption{Mark and Compact ved Garbage collection.}
\label{fig:markandsweep}
\end{figure}

\

\subsection{C\# compiler}
% hvad laver den

\subsection{Assembly}
% hvad er en assembli

\subsection{Overordnet arkitektur i .NET}

\subsection{Anvendelse af C\#}